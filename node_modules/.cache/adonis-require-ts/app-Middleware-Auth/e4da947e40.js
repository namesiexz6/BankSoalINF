"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class Auth {
    static authenticate() {
        throw new Error('Method not implemented.');
    }
    async handle({ auth, response, session }, next) {
        const token = session.get('token');
        if (!token) {
            const authenticate = await auth.use('web').authenticate();
            if (!authenticate) {
                await auth.check();
                response.redirect('/login');
            }
        }
        await next();
    }
}
exports.default = Auth;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0aC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkF1dGgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFFQSxNQUFxQixJQUFJO0lBQ3ZCLE1BQU0sQ0FBQyxZQUFZO1FBQ2YsTUFBTSxJQUFJLEtBQUssQ0FBQyx5QkFBeUIsQ0FBQyxDQUFBO0lBQzlDLENBQUM7SUFDTSxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQXVCLEVBQUUsSUFBeUI7UUFHN0YsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUNsQyxJQUFJLENBQUMsS0FBSyxFQUFFO1lBQ1YsTUFBTSxZQUFZLEdBQUcsTUFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLFlBQVksRUFBRSxDQUFBO1lBQ3pELElBQUksQ0FBQyxZQUFZLEVBQUU7Z0JBQ2pCLE1BQU0sSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFBO2dCQUNsQixRQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFBO2FBQzVCO1NBQ0Y7UUFFRCxNQUFNLElBQUksRUFBRSxDQUFBO0lBQ2QsQ0FBQztDQUNGO0FBbEJELHVCQWtCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgSHR0cENvbnRleHRDb250cmFjdCB9IGZyb20gJ0Bpb2M6QWRvbmlzL0NvcmUvSHR0cENvbnRleHQnXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBdXRoIHtcclxuICBzdGF0aWMgYXV0aGVudGljYXRlKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01ldGhvZCBub3QgaW1wbGVtZW50ZWQuJylcclxuICB9XHJcbiAgcHVibGljIGFzeW5jIGhhbmRsZSh7IGF1dGgsIHJlc3BvbnNlLCBzZXNzaW9uIH06IEh0dHBDb250ZXh0Q29udHJhY3QsIG5leHQ6ICgpID0+IFByb21pc2U8dm9pZD4pIHtcclxuICAgIC8vIGNvZGUgZm9yIG1pZGRsZXdhcmUgZ29lcyBoZXJlLiBBQk9WRSBUSEUgTkVYVCBDQUxMXHJcblxyXG4gICAgY29uc3QgdG9rZW4gPSBzZXNzaW9uLmdldCgndG9rZW4nKVxyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICBjb25zdCBhdXRoZW50aWNhdGUgPSBhd2FpdCBhdXRoLnVzZSgnd2ViJykuYXV0aGVudGljYXRlKClcclxuICAgICAgaWYgKCFhdXRoZW50aWNhdGUpIHtcclxuICAgICAgICBhd2FpdCBhdXRoLmNoZWNrKClcclxuICAgICAgICByZXNwb25zZS5yZWRpcmVjdCgnL2xvZ2luJylcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGF3YWl0IG5leHQoKVxyXG4gIH1cclxufVxyXG4iXX0=